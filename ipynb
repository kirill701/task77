import matplotlib.pyplot as plt
import csv

years = []         
pensions = []        

try:
    file = open('opendata.stat (1).csv', encoding='utf-8')
    reader = csv.reader(file)

    for row in reader:
        try:
            
            if len(row) > 2 and "Средняя пенсия" in row[0] and row[1] == "Забайкальский край" and row[2].startswith('2018'):
                if row[3].strip() != "":  
                    years.append(row[2])  
                    pensions.append(float(row[3]))  
        except ValueError:
            continue  
except (FileNotFoundError, PermissionError) as e:
    if isinstance(e, FileNotFoundError):
        print('Файл отсутствует')
    if isinstance(e, PermissionError):
        print('Нет прав доступа к файлу')
    exit()

if not pensions:
    print('Нет данных')
    exit()

average_pension = sum(pensions) / len(pensions)
rounded_average = round(average_pension, 2)

print(f"Средняя пенсия в рублях: {rounded_average}")

plt.plot(years, pensions, marker='o')
plt.xticks(rotation=30) 
plt.ylabel('Пенсия в руб.')
plt.title('Средняя пенсия в Забайкальском крае в 2018 году') 
plt.grid(True) 
plt.show()
